# üÜï STATUS ATUALIZADO 08/07/2025

- Todas as fases cr√≠ticas (4A, 4B, 5A, 5B) est√£o **conclu√≠das e validadas**.
- Fases de relat√≥rios e gest√£o avan√ßada de mesas (6A, 6B) est√£o **estruturadas e funcionais**.
- Fase 7 (polimentos) executada: app limpo, warnings m√≠nimos, pronto para produ√ß√£o.
- **NOVA FASE 8**: Sistema de Ciclo de Acertos - **PLANO APROVADO** e documentado.
- √öltima valida√ß√£o: 08/07/2025

---

# üöÄ REPLANEJAMENTO OTIMIZADO - GestaoBilhares

## üìã **AN√ÅLISE CR√çTICA DO ESTADO ATUAL**

### ‚úÖ **COMPONENTES FUNCIONAIS:**

- Login e Autentica√ß√£o
- Listagem de Rotas  
- Gerenciamento de Rotas (Admin)
- Lista de Clientes por Rota
- Hist√≥rico de Despesas

### ‚ùå **LACUNAS CR√çTICAS IDENTIFICADAS:**

1. **Detalhes do Cliente** - Bloqueando fluxo principal
2. **Sistema de Acertos** - Core business n√£o implementado
3. **Cadastros B√°sicos** - Sem dados para testar
4. **Recibos e Impress√£o** - Funcionalidade essencial
5. **Relat√≥rios** - An√°lise de neg√≥cio
6. **Gerenciamento de Mesas** - Controle de ativos

---

## üéØ **NOVA ESTRUTURA DE FASES - OTIMIZADA**

### **FASE 4A - URGENTE: Detalhes do Cliente + In√≠cio de Acertos**

**Prioridade: CR√çTICA | Tempo: 1-2 dias**

**Objetivo:** Completar fluxo b√°sico Cliente ‚Üí Acerto

**Implementar:**

1. **ClientDetailFragment** completo:
   - Layout com hist√≥rico de acertos
   - Bot√£o "Novo Acerto" funcional
   - Informa√ß√µes do cliente (mesas, d√©bitos)
   - Navega√ß√£o para acerto

2. **SettlementFragment** b√°sico:
   - Layout para m√∫ltiplas mesas
   - C√°lculos autom√°ticos (regras de neg√≥cio)
   - Salvamento de acerto
   - Mock data para mesas

3. **Navega√ß√£o completar:**
   - ClientListFragment ‚Üí ClientDetailFragment
   - ClientDetailFragment ‚Üí SettlementFragment

**Resultado:** Fluxo Login ‚Üí Rotas ‚Üí Clientes ‚Üí Detalhes ‚Üí Acerto FUNCIONAL

---

### **FASE 4B - CADASTROS ESSENCIAIS**

**Prioridade: ALTA | Tempo: 2-3 dias**

**Objetivo:** Dados reais substituindo mocks

**Implementar:**

1. **Tela Cadastros** (hub central):
   - RegistersFragment com navega√ß√£o
   - Controle de acesso por permiss√£o

2. **Cadastro de Cliente**:
   - Formul√°rio completo
   - Vincula√ß√£o com rotas
   - Valor por ficha

3. **Cadastro de Mesa**:
   - Dados b√°sicos da mesa
   - Status (dispon√≠vel/locada)
   - Hist√≥rico de loca√ß√£o

4. **Cadastro de Colaborador** (Admin):
   - Dados pessoais e acesso
   - N√≠veis de permiss√£o

**Resultado:** Sistema com dados reais, sem depend√™ncia de mocks

---

### **FASE 5A - ACERTOS COMPLETOS + MESAS**

**Prioridade: ALTA | Tempo: 2-3 dias**

**Objetivo:** Sistema de acertos completo + gest√£o de mesas

**Implementar:**

1. **Tela "Mesas"** (sele√ß√£o para clientes):
   - Lista de mesas dispon√≠veis
   - Filtros por status
   - Vincula√ß√£o a cliente
   - Transfer√™ncia entre clientes

2. **Acerto avan√ßado**:
   - Adicionar/remover mesas dinamicamente
   - Valida√ß√µes (fichas final < inicial)
   - C√°lculos complexos autom√°ticos
   - Observa√ß√µes e m√©todos de pagamento

3. **SettlementDetailFragment**:
   - Hist√≥rico detalhado de acerto
   - Bot√£o para editar (se permitido)
   - Navega√ß√£o para recibo

**Resultado:** Core business completo e funcional

---

### **FASE 5B - RECIBOS E IMPRESS√ÉO**

**Prioridade: M√âDIA | Tempo: 2-3 dias**

**Objetivo:** Finaliza√ß√£o do ciclo de acerto

**Implementar:**

1. **ReceiptFragment**:
   - Layout otimizado para impress√£o 58mm
   - QR Code com dados do acerto
   - Informa√ß√µes completas

2. **Impress√£o Bluetooth**:
   - BluetoothPrinterManager
   - Descoberta e conex√£o
   - Formata√ß√£o para 58mm

3. **Compartilhamento WhatsApp**:
   - Intent para WhatsApp
   - Formata√ß√£o de mensagem
   - Anexo de recibo

**Resultado:** Ciclo completo: Acerto ‚Üí Recibo ‚Üí Impress√£o/WhatsApp

---

### **FASE 6A - RELAT√ìRIOS B√ÅSICOS**

**Prioridade: M√âDIA | Tempo: 3-4 dias**

**Objetivo:** An√°lise de dados e fechamento de rotas

**Implementar:**

1. **ReportsFragment**:
   - Filtros por data, rota, colaborador
   - Tipos: Rota, Consolidado, Desempenho
   - C√°lculos autom√°ticos

2. **M√©tricas essenciais**:
   - Valores recebidos/pendentes
   - Percentual de pagantes
   - Comparativos mensais
   - Desempenho por colaborador

3. **ReportHistoryFragment**:
   - Lista de relat√≥rios finalizados
   - Filtros e busca
   - Navega√ß√£o para detalhes

**Resultado:** An√°lise de neg√≥cio e controle gerencial

---

### **FASE 6B - GEST√ÉO AVAN√áADA DE MESAS**

**Prioridade: M√âDIA | Tempo: 2-3 dias**

**Objetivo:** Controle completo do ativo principal

**Implementar:**

1. **TableManagementFragment**:
   - Lista completa de mesas
   - Filtros por status, cliente, rota
   - A√ß√µes: transferir, editar, depot

2. **Regras de transfer√™ncia**:
   - Fichas Final ‚Üí Fichas Inicial
   - Hist√≥rico de transfer√™ncias
   - Valida√ß√µes de neg√≥cio

3. **Cadastro avan√ßado de mesa**:
   - Dados t√©cnicos completos
   - Hist√≥rico de manuten√ß√£o
   - Fotos e documenta√ß√£o

**Resultado:** Controle total do ativo "mesas"

---

### **FASE 7 - SINCRONIZA√á√ÉO E POLIMENTOS**

**Prioridade: BAIXA | Tempo: 3-4 dias**

**Objetivo:** App production-ready

**Implementar:**

1. **Firebase Firestore**:
   - Sincroniza√ß√£o bidirecional
   - Resolu√ß√£o de conflitos
   - Backup na nuvem

2. **Melhorias de UX**:
   - Anima√ß√µes entre telas
   - Loading states
   - Error handling aprimorado
   - Modo escuro

3. **Performance**:
   - Pagina√ß√£o em listas grandes
   - Cache de imagens
   - Otimiza√ß√£o de queries

**Resultado:** App completo e otimizado para produ√ß√£o

---

### **FASE 8 - SISTEMA DE CICLO DE ACERTOS**

**Prioridade: ALTA | Tempo: 5-7 dias**

**Objetivo:** Sistema profissional de gest√£o por ciclos de acerto

**Implementar:**

1. **Refatora√ß√£o das Entidades**:
   - Adicionar v√≠nculos rota/ciclo em Acerto e Despesa
   - Criar entidade CicloAcertoEntity para hist√≥rico
   - Migra√ß√£o do banco para vers√£o 7

2. **Atualiza√ß√£o dos DAOs**:
   - Queries por rota e ciclo
   - Estat√≠sticas por ciclo
   - Relat√≥rios consolidados

3. **Tela Clientes da Rota**:
   - Busca por nome em tempo real
   - Exibi√ß√£o do status do ciclo
   - Controle manual de in√≠cio/fim do ciclo

4. **Filtro Global na Tela Rotas**:
   - Spinner para sele√ß√£o de ciclo (1¬∫, 2¬∫, etc.)
   - Filtro global para todas as rotas
   - Exibi√ß√£o dos resultados por ciclo

5. **Sistema de Relat√≥rios**:
   - Relat√≥rio por ciclo com detalhamento
   - Exporta√ß√£o PDF
   - Controle de acesso (admin master)

**Resultado:** Sistema completo de gest√£o por ciclos com relat√≥rios profissionais

---

## üìà **ESTRAT√âGIA DE IMPLEMENTA√á√ÉO**

### **REGRAS DE EFICI√äNCIA:**

1. **Mock Data Primeiro**: Cada tela funciona com dados fake antes de integra√ß√£o
2. **Teste Cont√≠nuo**: Cada fase deve ser testada antes da pr√≥xima
3. **Clean Build**: A cada fase conclu√≠da
4. **Navega√ß√£o Primeiro**: UI naveg√°vel antes de l√≥gica complexa

### **PRIORIZA√á√ÉO INTELIGENTE:**

- **Fases 4A e 4B**: CR√çTICAS - Bloqueiam todo o resto
- **Fases 5A e 5B**: ALTAS - Core business
- **Fases 6A e 6B**: M√âDIAS - Valor agregado
- **Fase 7**: BAIXA - Polimento
- **Fase 8**: ALTA - Sistema de ciclo de acertos (core business)

### **CRIT√âRIOS DE CONCLUS√ÉO:**

‚úÖ Cada fase deve ter ALL funcionalidades testadas  
‚úÖ Navega√ß√£o completa entre telas  
‚úÖ Mock data funcionando (se aplic√°vel)  
‚úÖ Sem crashes na navega√ß√£o  
‚úÖ UI responsiva e bonita  

---

## üéØ **FUNCIONALIDADES POR FASE - DETALHADO**

### **TELAS IMPLEMENTADAS vs PLANEJADAS:**

| Tela | Status Atual | Fase Planejada | Prioridade |
|------|-------------|----------------|------------|
| 1. Login | ‚úÖ Conclu√≠da | - | - |
| 2. Rotas | ‚úÖ Conclu√≠da | - | - |
| 2.1. Gerenciar Rotas | ‚úÖ Conclu√≠da | - | - |
| 3. Lista Clientes | ‚úÖ Conclu√≠da | - | - |
| 4. **Detalhes Cliente** | ‚ùå **FALTA** | **Fase 4A** | **CR√çTICA** |
| 5. **Novo Acerto** | ‚ùå **FALTA** | **Fase 4A** | **CR√çTICA** |
| 6. **Hist√≥rico Acerto** | ‚ùå **FALTA** | **Fase 5A** | **ALTA** |
| 7. **Recibo** | ‚ùå **FALTA** | **Fase 5B** | **ALTA** |
| 8. **Relat√≥rios** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 9. **Hist√≥rico Relat√≥rios** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 10. **Relat√≥rio Detalhado** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 11. **Cadastros (Hub)** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 12. **Cadastro Cliente** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 13. **Cadastro Colaborador** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 14. **Cadastro Despesa** | ‚ùå **FALTA** | **Fase 4B** | **M√âDIA** |
| 15. **Cadastro Mesa** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 16. **Tela Mesas** | ‚ùå **FALTA** | **Fase 5A** | **ALTA** |
| **Extra:** Hist√≥rico Despesas | ‚úÖ Conclu√≠da | - | - |
| **17. Sistema Ciclo Acertos** | ‚ùå **FALTA** | **Fase 8** | **ALTA** |

### **FUNCIONALIDADES CR√çTICAS DO FLUXO:**

**FLUXO PRINCIPAL FALTANDO:**

1. **Detalhes do Cliente** (tela 4) ‚Üê BLOQUEIO TOTAL
2. **Bot√£o "Novo Acerto"** ‚Üê CORE BUSINESS  
3. **Tela "Mesas"** para sele√ß√£o ‚Üê NECESS√ÅRIO PARA ACERTOS
4. **Cadastros b√°sicos** ‚Üê SEM DADOS REAIS
5. **Sistema de Ciclo de Acertos** ‚Üê GEST√ÉO PROFISSIONAL

---

## üö® **A√á√ÉO IMEDIATA RECOMENDADA**

### **COME√áAR AGORA: FASE 4A**

**Motivo:** Desbloquear√° todo o fluxo principal do app

**Primeiros passos:**

1. ‚úÖ Implementar `ClientDetailFragment`
2. ‚úÖ Criar layout b√°sico para `SettlementFragment`
3. ‚úÖ Adicionar navega√ß√£o no `nav_graph.xml`
4. ‚úÖ Testar fluxo: Rotas ‚Üí Clientes ‚Üí Detalhes ‚Üí Acerto

**Resultado esperado:** Em 1-2 dias o fluxo principal estar√° funcional!

---

## üÜï **A√á√ÉO IMEDIATA RECOMENDADA - FASE 8**

**Motivo:** Sistema de ciclo de acertos √© core business para gest√£o profissional

**Primeiros passos:**

1. üîÑ Refatorar entidade `Acerto` (adicionar `rotaId` e `cicloAcerto`)
2. üîÑ Refatorar entidade `Despesa` (adicionar `cicloAcerto`)
3. üîÑ Criar entidade `CicloAcertoEntity` para hist√≥rico
4. üîÑ Migrar banco de dados para vers√£o 7
5. üîÑ Atualizar DAOs com queries por ciclo

**Resultado esperado:** Em 5-7 dias o sistema de ciclo estar√° completo!

---

## üÜï **NOVA FASE 8: SISTEMA DE CICLO DE ACERTOS**

### **üìã AN√ÅLISE PROFISSIONAL REALIZADA - 08/07/2025**

**Estado Atual Identificado:**

- ‚úÖ **Entidade `Rota`**: Possui campos para ciclo (`cicloAcertoAtual`, `anoCiclo`, `dataInicioCiclo`, `dataFimCiclo`, `statusAtual`)
- ‚ùå **Entidade `Acerto`**: **FALTA** v√≠nculo com rota (`rotaId`) e ciclo (`cicloAcerto`)
- ‚úÖ **Entidade `Despesa`**: Possui v√≠nculo com rota (`rotaId`), mas ‚ùå **FALTA** v√≠nculo com ciclo
- ‚úÖ **DAO da Rota**: Possui m√©todos para controle de ciclo (`iniciarCicloRota`, `finalizarCicloRota`)
- ‚ùå **DAO do Acerto**: **FALTA** queries por rota e ciclo
- ‚úÖ **Tela Clientes da Rota**: Possui estrutura b√°sica, mas ‚ùå **FALTA** busca por nome e exibi√ß√£o de status
- ‚úÖ **Tela Rotas**: Possui estrutura, mas ‚ùå **FALTA** filtro global por ciclo

### **üéØ PLANO DE A√á√ÉO PROFISSIONAL**

#### **FASE 8A - REFATORA√á√ÉO DAS ENTIDADES E V√çNCULOS**

**Prioridade: ALTA | Tempo: 1-2 dias**

- **8A.1** Adicionar `rotaId: Long` e `cicloAcerto: Int` na entidade `Acerto`
- **8A.2** Adicionar `cicloAcerto: Int` na entidade `Despesa` (opcional, mas recomendado)
- **8A.3** Criar entidade `CicloAcertoEntity` para hist√≥rico de ciclos finalizados
- **8A.4** Migra√ß√£o do banco de dados para vers√£o 7

#### **FASE 8B - ATUALIZA√á√ÉO DOS DAOs E REPOSIT√ìRIOS**

**Prioridade: ALTA | Tempo: 1-2 dias**

- **8B.1** AcertoDao: Adicionar queries por rota e ciclo
- **8B.2** DespesaDao: Adicionar queries por ciclo (se implementado)
- **8B.3** RotaDao: Queries para estat√≠sticas por ciclo e relat√≥rios

#### **FASE 8C - IMPLEMENTA√á√ÉO DA TELA CLIENTES DA ROTA**

**Prioridade: ALTA | Tempo: 2-3 dias**

- **8C.1** Busca por nome com filtro em tempo real
- **8C.2** Exibi√ß√£o do status do ciclo atual com controle visual
- **8C.3** Bot√µes para iniciar/finalizar ciclo manualmente
- **8C.4** Card destacado no topo da tela com informa√ß√µes do ciclo

#### **FASE 8D - IMPLEMENTA√á√ÉO DO FILTRO GLOBAL NA TELA ROTAS**

**Prioridade: M√âDIA | Tempo: 1-2 dias**

- **8D.1** Filtro por ciclo (1¬∫ Acerto, 2¬∫ Acerto, etc.) - global para todas as rotas
- **8D.2** Spinner fixo no topo da tela Rotas
- **8D.3** Exibi√ß√£o dos resultados filtrados por ciclo selecionado

#### **FASE 8E - SISTEMA DE RELAT√ìRIOS**

**Prioridade: M√âDIA | Tempo: 2-3 dias**

- **8E.1** Relat√≥rio por ciclo com detalhamento por cliente/mesa
- **8E.2** Totais consolidados e exporta√ß√£o PDF
- **8E.3** Controle de acesso: despesas bloqueadas para edi√ß√£o (apenas admin master)
- **8E.4** Dados tabulares + gr√°ficos/estat√≠sticas visuais

### **‚ùì PERGUNTAS ESCLARECEDORAS RESPONDIDAS**

1. ‚úÖ **Busca por nome**: Busca em tempo real (conforme digita)
2. ‚úÖ **Exibi√ß√£o do status**: Card destacado no topo da tela
3. ‚úÖ **Filtro global**: Spinner fixo no topo da tela Rotas
4. ‚úÖ **Relat√≥rio PDF**: Dados tabulares + gr√°ficos/estat√≠sticas visuais
5. ‚úÖ **Controle de admin master**: Verificar entidade `Colaborador` com n√≠vel de acesso
6. ‚úÖ **Hist√≥rico de ciclos**: Manter hist√≥rico de √∫ltimos 12 meses
7. ‚úÖ **Incremento manual**: Na tela Clientes da Rota

### **üöÄ PR√ìXIMOS PASSOS IMEDIATOS**

1. **Refatora√ß√£o das entidades** (Acerto, Despesa, nova CicloAcertoEntity)
2. **Atualiza√ß√£o dos DAOs** com queries por ciclo
3. **Implementa√ß√£o da busca por nome** na tela Clientes da Rota
4. **Exibi√ß√£o do status do ciclo** com controle visual
5. **Filtro global por ciclo** na tela Rotas
6. **Sistema de relat√≥rios** com exporta√ß√£o PDF
7. **Controle de acesso** para despesas

**Status:** üÜï PLANO APROVADO - AGUARDANDO IMPLEMENTA√á√ÉO
**Prioridade:** ALTA - Sistema de ciclo √© core business
**Tempo Estimado:** 5-7 dias
**Impacto:** Melhoria significativa na gest√£o e relat√≥rios

---

**Este replanejamento prioriza VELOCIDADE e FUNCIONALIDADE, garantindo que cada fase entrega valor real ao usu√°rio.**

**√öLTIMA ATUALIZA√á√ÉO:** 08/07/2025 15:45
**NOVA FASE:** Sistema de Ciclo de Acertos - PLANO APROVADO
