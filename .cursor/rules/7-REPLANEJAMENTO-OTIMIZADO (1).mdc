---
description:
globs:
alwaysApply: false
---
# üöÄ REPLANEJAMENTO OTIMIZADO - GestaoBilhares

## üìã **AN√ÅLISE CR√çTICA DO ESTADO ATUAL**

### ‚úÖ **COMPONENTES FUNCIONAIS:**
- Login e Autentica√ß√£o
- Listagem de Rotas  
- Gerenciamento de Rotas (Admin)
- Lista de Clientes por Rota
- Hist√≥rico de Despesas

### ‚ùå **LACUNAS CR√çTICAS IDENTIFICADAS:**
1. **Detalhes do Cliente** - Bloqueando fluxo principal
2. **Sistema de Acertos** - Core business n√£o implementado
3. **Cadastros B√°sicos** - Sem dados para testar
4. **Recibos e Impress√£o** - Funcionalidade essencial
5. **Relat√≥rios** - An√°lise de neg√≥cio
6. **Gerenciamento de Mesas** - Controle de ativos

---

## üéØ **NOVA ESTRUTURA DE FASES - OTIMIZADA**

### **FASE 4A - URGENTE: Detalhes do Cliente + In√≠cio de Acertos** 
**Prioridade: CR√çTICA | Tempo: 1-2 dias**

**Objetivo:** Completar fluxo b√°sico Cliente ‚Üí Acerto

**Implementar:**
1. **ClientDetailFragment** completo:
   - Layout com hist√≥rico de acertos
   - Bot√£o "Novo Acerto" funcional
   - Informa√ß√µes do cliente (mesas, d√©bitos)
   - Navega√ß√£o para acerto

2. **SettlementFragment** b√°sico:
   - Layout para m√∫ltiplas mesas
   - C√°lculos autom√°ticos (regras de neg√≥cio)
   - Salvamento de acerto
   - Mock data para mesas

3. **Navega√ß√£o completar:**
   - ClientListFragment ‚Üí ClientDetailFragment
   - ClientDetailFragment ‚Üí SettlementFragment

**Resultado:** Fluxo Login ‚Üí Rotas ‚Üí Clientes ‚Üí Detalhes ‚Üí Acerto FUNCIONAL

---

### **FASE 4B - CADASTROS ESSENCIAIS**
**Prioridade: ALTA | Tempo: 2-3 dias**

**Objetivo:** Dados reais substituindo mocks

**Implementar:**
1. **Tela Cadastros** (hub central):
   - RegistersFragment com navega√ß√£o
   - Controle de acesso por permiss√£o

2. **Cadastro de Cliente**:
   - Formul√°rio completo
   - Vincula√ß√£o com rotas
   - Valor por ficha

3. **Cadastro de Mesa**:
   - Dados b√°sicos da mesa
   - Status (dispon√≠vel/locada)
   - Hist√≥rico de loca√ß√£o

4. **Cadastro de Colaborador** (Admin):
   - Dados pessoais e acesso
   - N√≠veis de permiss√£o

**Resultado:** Sistema com dados reais, sem depend√™ncia de mocks

---

### **FASE 5A - ACERTOS COMPLETOS + MESAS**
**Prioridade: ALTA | Tempo: 2-3 dias**

**Objetivo:** Sistema de acertos completo + gest√£o de mesas

**Implementar:**
1. **Tela "Mesas"** (sele√ß√£o para clientes):
   - Lista de mesas dispon√≠veis
   - Filtros por status
   - Vincula√ß√£o a cliente
   - Transfer√™ncia entre clientes

2. **Acerto avan√ßado**:
   - Adicionar/remover mesas dinamicamente
   - Valida√ß√µes (fichas final < inicial)
   - C√°lculos complexos autom√°ticos
   - Observa√ß√µes e m√©todos de pagamento

3. **SettlementDetailFragment**:
   - Hist√≥rico detalhado de acerto
   - Bot√£o para editar (se permitido)
   - Navega√ß√£o para recibo

**Resultado:** Core business completo e funcional

---

### **FASE 5B - RECIBOS E IMPRESS√ÉO**
**Prioridade: M√âDIA | Tempo: 2-3 dias**

**Objetivo:** Finaliza√ß√£o do ciclo de acerto

**Implementar:**
1. **ReceiptFragment**:
   - Layout otimizado para impress√£o 58mm
   - QR Code com dados do acerto
   - Informa√ß√µes completas

2. **Impress√£o Bluetooth**:
   - BluetoothPrinterManager
   - Descoberta e conex√£o
   - Formata√ß√£o para 58mm

3. **Compartilhamento WhatsApp**:
   - Intent para WhatsApp
   - Formata√ß√£o de mensagem
   - Anexo de recibo

**Resultado:** Ciclo completo: Acerto ‚Üí Recibo ‚Üí Impress√£o/WhatsApp

---

### **FASE 6A - RELAT√ìRIOS B√ÅSICOS**
**Prioridade: M√âDIA | Tempo: 3-4 dias**

**Objetivo:** An√°lise de dados e fechamento de rotas

**Implementar:**
1. **ReportsFragment**:
   - Filtros por data, rota, colaborador
   - Tipos: Rota, Consolidado, Desempenho
   - C√°lculos autom√°ticos

2. **M√©tricas essenciais**:
   - Valores recebidos/pendentes
   - Percentual de pagantes
   - Comparativos mensais
   - Desempenho por colaborador

3. **ReportHistoryFragment**:
   - Lista de relat√≥rios finalizados
   - Filtros e busca
   - Navega√ß√£o para detalhes

**Resultado:** An√°lise de neg√≥cio e controle gerencial

---

### **FASE 6B - GEST√ÉO AVAN√áADA DE MESAS**
**Prioridade: M√âDIA | Tempo: 2-3 dias**

**Objetivo:** Controle completo do ativo principal

**Implementar:**
1. **TableManagementFragment**:
   - Lista completa de mesas
   - Filtros por status, cliente, rota
   - A√ß√µes: transferir, editar, depot

2. **Regras de transfer√™ncia**:
   - Fichas Final ‚Üí Fichas Inicial
   - Hist√≥rico de transfer√™ncias
   - Valida√ß√µes de neg√≥cio

3. **Cadastro avan√ßado de mesa**:
   - Dados t√©cnicos completos
   - Hist√≥rico de manuten√ß√£o
   - Fotos e documenta√ß√£o

**Resultado:** Controle total do ativo "mesas"

---

### **FASE 7 - SINCRONIZA√á√ÉO E POLIMENTOS**
**Prioridade: BAIXA | Tempo: 3-4 dias**

**Objetivo:** App production-ready

**Implementar:**
1. **Firebase Firestore**:
   - Sincroniza√ß√£o bidirecional
   - Resolu√ß√£o de conflitos
   - Backup na nuvem

2. **Melhorias de UX**:
   - Anima√ß√µes entre telas
   - Loading states
   - Error handling aprimorado
   - Modo escuro

3. **Performance**:
   - Pagina√ß√£o em listas grandes
   - Cache de imagens
   - Otimiza√ß√£o de queries

**Resultado:** App completo e otimizado para produ√ß√£o

---

## üìà **ESTRAT√âGIA DE IMPLEMENTA√á√ÉO**

### **REGRAS DE EFICI√äNCIA:**
1. **Mock Data Primeiro**: Cada tela funciona com dados fake antes de integra√ß√£o
2. **Teste Cont√≠nuo**: Cada fase deve ser testada antes da pr√≥xima
3. **Clean Build**: A cada fase conclu√≠da
4. **Navega√ß√£o Primeiro**: UI naveg√°vel antes de l√≥gica complexa

### **PRIORIZA√á√ÉO INTELIGENTE:**
- **Fases 4A e 4B**: CR√çTICAS - Bloqueiam todo o resto
- **Fases 5A e 5B**: ALTAS - Core business
- **Fases 6A e 6B**: M√âDIAS - Valor agregado
- **Fase 7**: BAIXA - Polimento

### **CRIT√âRIOS DE CONCLUS√ÉO:**
‚úÖ Cada fase deve ter ALL funcionalidades testadas  
‚úÖ Navega√ß√£o completa entre telas  
‚úÖ Mock data funcionando (se aplic√°vel)  
‚úÖ Sem crashes na navega√ß√£o  
‚úÖ UI responsiva e bonita  

---

## üéØ **FUNCIONALIDADES POR FASE - DETALHADO**

### **TELAS IMPLEMENTADAS vs PLANEJADAS:**

| Tela | Status Atual | Fase Planejada | Prioridade |
|------|-------------|----------------|------------|
| 1. Login | ‚úÖ Conclu√≠da | - | - |
| 2. Rotas | ‚úÖ Conclu√≠da | - | - |
| 2.1. Gerenciar Rotas | ‚úÖ Conclu√≠da | - | - |
| 3. Lista Clientes | ‚úÖ Conclu√≠da | - | - |
| 4. **Detalhes Cliente** | ‚ùå **FALTA** | **Fase 4A** | **CR√çTICA** |
| 5. **Novo Acerto** | ‚ùå **FALTA** | **Fase 4A** | **CR√çTICA** |
| 6. **Hist√≥rico Acerto** | ‚ùå **FALTA** | **Fase 5A** | **ALTA** |
| 7. **Recibo** | ‚ùå **FALTA** | **Fase 5B** | **ALTA** |
| 8. **Relat√≥rios** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 9. **Hist√≥rico Relat√≥rios** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 10. **Relat√≥rio Detalhado** | ‚ùå **FALTA** | **Fase 6A** | **M√âDIA** |
| 11. **Cadastros (Hub)** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 12. **Cadastro Cliente** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 13. **Cadastro Colaborador** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 14. **Cadastro Despesa** | ‚ùå **FALTA** | **Fase 4B** | **M√âDIA** |
| 15. **Cadastro Mesa** | ‚ùå **FALTA** | **Fase 4B** | **ALTA** |
| 16. **Tela Mesas** | ‚ùå **FALTA** | **Fase 5A** | **ALTA** |
| **Extra:** Hist√≥rico Despesas | ‚úÖ Conclu√≠da | - | - |

### **FUNCIONALIDADES CR√çTICAS DO FLUXO:**

**FLUXO PRINCIPAL FALTANDO:**
1. **Detalhes do Cliente** (tela 4) ‚Üê BLOQUEIO TOTAL
2. **Bot√£o "Novo Acerto"** ‚Üê CORE BUSINESS  
3. **Tela "Mesas"** para sele√ß√£o ‚Üê NECESS√ÅRIO PARA ACERTOS
4. **Cadastros b√°sicos** ‚Üê SEM DADOS REAIS

---

## üö® **A√á√ÉO IMEDIATA RECOMENDADA**

### **COME√áAR AGORA: FASE 4A**
**Motivo:** Desbloquear√° todo o fluxo principal do app

**Primeiros passos:**
1. ‚úÖ Implementar `ClientDetailFragment` 
2. ‚úÖ Criar layout b√°sico para `SettlementFragment`
3. ‚úÖ Adicionar navega√ß√£o no `nav_graph.xml`
4. ‚úÖ Testar fluxo: Rotas ‚Üí Clientes ‚Üí Detalhes ‚Üí Acerto

**Resultado esperado:** Em 1-2 dias o fluxo principal estar√° funcional!

---

**Este replanejamento prioriza VELOCIDADE e FUNCIONALIDADE, garantindo que cada fase entrega valor real ao usu√°rio.**
