# üîÑ WINDSURF WORKFLOWS - GEST√ÉO DE BILHARES

> Workflows automatizados para desenvolvimento com alta autonomia  
> Vers√£o: 1.0  
> Baseado no protocolo Gates e documenta√ß√£o do projeto

---

## üéØ WORKFLOWS PRINCIPAIS

### 1. üîß BUG FIX WORKFLOW
**Trigger:** `bug_fix` ou ao identificar erro

```yaml
name: Bug Fix
description: Corre√ß√£o de bugs seguindo protocolo Gates (m√°x 2 builds)

steps:
  - name: "Gate 0 - Diagn√≥stico"
    type: analysis
    actions:
      - Ler PROJECT_README.md (se√ß√£o do componente)
      - Static Analysis do c√≥digo (rg, grep)
      - Classificar bug: Regress√£o vs Mist√©rio
      - Definir m√©todo: Static (1 build) vs Dynamic (2 builds)
      
  - name: "Gate 1 - Plano Cir√∫rgico"
    type: planning
    actions:
      - Identificar arquivo-alvo
      - Definir linhas espec√≠ficas
      - Descrever mudan√ßa exata
      - Estabelecer valida√ß√£o m√≠nima
      
  - name: "Gate 2 - Escopo Delimitado"
    type: scope
    actions:
      - Listar arquivos que ser√£o modificados
      - Listar arquivos que N√ÉO ser√£o tocados
      - Identificar depend√™ncias impactadas
      
  - name: "Gate 3 - Execu√ß√£o Incremental"
    type: implementation
    actions:
      - Implementar uma mudan√ßa por vez
      - Build: `.\gradlew.bat :app:assembleDebug`
      - Testar: `.\gradlew.bat testDebugUnitTest`
      - Rollback se piorar
      
  - name: "Gate 4 - Parada Obrigat√≥ria"
    type: validation
    actions:
      - Parar ap√≥s 2 builds sem sucesso
      - Pedir ajuda humana ap√≥s 3 tentativas
      - Documentar solu√ß√£o encontrada
```

### 2. üöÄ FEATURE DEVELOPMENT WORKFLOW
**Trigger:** `new_feature` ou `implement`

```yaml
name: Feature Development
description: Desenvolvimento de novas funcionalidades seguindo arquitetura

steps:
  - name: "An√°lise de Requisitos"
    type: analysis
    actions:
      - Ler PROJECT_README.md (componentes afetados)
      - Identificar ViewModels, DAOs, Repositories necess√°rios
      - Verificar regras de neg√≥cio no DEV_GUIDE.md
      
  - name: "Design da Arquitetura"
    type: design
    actions:
      - Definir entidades (Room + Firestore)
      - Projetar DAO com queries otimizadas
      - Implementar Repository com sync
      - Criar ViewModel com StateFlow
      
  - name: "Implementa√ß√£o Camada de Dados"
    type: data_layer
    actions:
      - Criar Entity com empresa_id/rota_id
      - Implementar DAO com @Query
      - Criar Repository interface + impl
      - Adicionar testes unit√°rios
      
  - name: "Implementa√ß√£o Camada de UI"
    type: ui_layer
    actions:
      - Criar ViewModel @HiltViewModel
      - Implementar Fragment com observa√ß√£o StateFlow
      - Adicionar valida√ß√µes de neg√≥cio
      - Testar integra√ß√£o
      
  - name: "Integra√ß√£o e Sync"
    type: integration
    actions:
      - Implementar sync com Firestore
      - Adicionar em SyncOperation
      - Testar offline-first
      - Validar multi-tenancy
      
  - name: "Valida√ß√£o Final"
    type: validation
    actions:
      - Build completo: `.\gradlew.bat :app:assembleDebug --build-cache --parallel`
      - Testes: `.\gradlew.bat testDebugUnitTest`
      - Verificar checklist do .windsurfrules
```

### 3. üîç DEBUGGING WORKFLOW
**Trigger:** `debug` ou problema misterioso

```yaml
name: Debugging
description: Diagn√≥stico de problemas complexos com logs e evid√™ncias

steps:
  - name: "Classifica√ß√£o do Problema"
    type: classification
    actions:
      - Identificar tipo: UI, Dados, Sync, Performance
      - Verificar se √© regress√£o ("funcionava antes")
      - Escolher m√©todo: Static vs Dynamic Analysis
      
  - name: "Static Analysis"
    type: static_analysis
    actions:
      - Buscar padr√µes: `rg "padr√£o" --type kt -C 5`
      - Analisar camadas: DAO ‚Üí Repository ‚Üí ViewModel ‚Üí UI
      - Verificar invariantes do neg√≥cio
      - Identificar ponto de perda de dados
      
  - name: "Dynamic Analysis"
    type: dynamic_analysis
    actions:
      - Adicionar logs estrat√©gicos com [TAG]
      - Build com logs: `.\gradlew.bat :app:assembleDebug`
      - Capturar logs: `%ADB_PATH% logcat -s [DIAGNOSTICO]:D`
      - Analisar fluxo de dados
      
  - name: "Diagn√≥stico e Corre√ß√£o"
    type: fix
    actions:
      - Isolar causa raiz
      - Implementar corre√ß√£o m√≠nima
      - Validar com build + testes
      - Documentar solu√ß√£o
```

### 4. üìä REFACTORING WORKFLOW
**Trigger:** `refactor` ou d√©bito t√©cnico

```yaml
name: Refactoring
description: Melhoria de c√≥digo baseado em TECHNICAL_DEBT.md

steps:
  - name: "Identifica√ß√£o do D√©bito"
    type: identification
    actions:
      - Consultar TECHNICAL_DEBT.md
      - Priorizar por criticidade (CR√çTICO > ALTO > M√âDIO)
      - Verificar impacto no sistema
      
  - name: "Planejamento da Refatora√ß√£o"
    type: planning
    actions:
      - Dividir em mudan√ßas pequenas
      - Preservar funcionalidades
      - Planejar testes de regress√£o
      
  - name: "Execu√ß√£o Incremental"
    type: execution
    actions:
      - Refatorar uma classe por vez
      - Manter testes passando
      - Build a cada mudan√ßa
      - Verificar n√£o quebrar fluxos
      
  - name: "Valida√ß√£o e Documenta√ß√£o"
    type: validation
    actions:
      - Testes completos: `.\gradlew.bat testDebugUnitTest`
      - Verificar performance
      - Atualizar documenta√ß√£o
      - Marcar d√©bito como resolvido
```

---

## üéõÔ∏è WORKFLOWS AUTOMATIZADOS

### 5. üöÄ QUICK BUILD WORKFLOW
**Trigger:** `build` ou `compile`

```yaml
name: Quick Build
description: Build r√°pido com cache e valida√ß√µes

steps:
  - name: "Build Otimizado"
    command: .\gradlew.bat :app:assembleDebug --build-cache --parallel
    
  - name: "Valida√ß√µes R√°pidas"
    checks:
      - Multi-tenancy respeitado?
      - Offline-first mantido?
      - Sem erros de compila√ß√£o?
      
  - name: "Resultado"
    output: |
      ‚úÖ Build conclu√≠do em {tempo}s
      üì¶ APK: app/build/outputs/apk/debug/app-debug.apk
      üîÑ Cache: {status}
```

### 6. üß™ TEST WORKFLOW
**Trigger:** `test` ou `validate`

```yaml
name: Test Suite
description: Execu√ß√£o completa de testes

steps:
  - name: "Testes Unit√°rios"
    command: .\gradlew.bat testDebugUnitTest
    
  - name: "Testes de Integra√ß√£o"
    command: .\gradlew.bat connectedDebugAndroidTest
    
  - name: "Cobertura de C√≥digo"
    analysis:
      - Atual: {coverage}%
      - Meta: 30% (2 semanas)
      - Status: {status}
      
  - name: "Relat√≥rio"
    output: |
      üìä Testes: {pass}/{total} passando
      üéØ Cobertura: {coverage}%
      ‚ö†Ô∏è Falhas: {failures}
```

### 7. üì± DEPLOY WORKFLOW
**Trigger:** `deploy` ou `release`

```yaml
name: Deploy
description: Deploy para Firebase App Distribution

steps:
  - name: "Build Release"
    command: .\gradlew.bat :app:assembleRelease
    
  - name: "Upload Firebase"
    command: firebase appdistribution:distribute app/build/outputs/apk/release/app-release.apk
    
  - name: "Notifica√ß√£o"
    notification:
      - Vers√£o: {version}
      - Testers: {group}
      - Release notes: {notes}
```

---

## üîß WORKFLOWS DE MANUTEN√á√ÉO

### 8. üîç MONITORING WORKFLOW
**Trigger:** `monitor` ou semanal

```yaml
name: Weekly Monitoring
description: Monitoramento semanal do sistema

steps:
  - name: "Violations Firestore"
    check: Firebase Console ‚Üí Firestore ‚Üí Rules
    time: 15min
    
  - name: "Performance Sync"
    logs: %ADB_PATH% logcat -s [SYNC]:D
    time: 10min
    
  - name: "Estrutura Database"
    inspector: Database Inspector
    time: 10min
    
  - name: "Relat√≥rio"
    output: monitoramento/relatorios/{date}.md
```

### 9. üßπ CLEANUP WORKFLOW
**Trigger:** `cleanup` ou manuten√ß√£o

```yaml
name: Cleanup
description: Limpeza de arquivos e otimiza√ß√£o

steps:
  - name: "Limpar Build"
    command: .\gradlew.bat clean
    
  - name: "Remover Tempor√°rios"
    files:
      - *.log
      - *.tmp
      - build/
      - .gradle/
      
  - name: "Otimizar Cache"
    command: .\gradlew.bat :app:assembleDebug --build-cache --parallel
```

---

## üéÆ COMANDOS R√ÅPIDOS

### Atalhos do WindSurf
```bash
# Iniciar workflow de bug fix
/wind workflow bug_fix

# Build r√°pido
/wind build

# Debug completo
/wind debug

# Nova feature
/wind new_feature

# Monitoramento
/wind monitor

# Refatora√ß√£o
/wind refactor

# Testes completos
/wind test

# Deploy
/wind deploy
```

### Snippets Autom√°ticos
```kotlin
# ViewModel pattern
/wind snippet viewmodel

# DAO pattern  
/wind snippet dao

# Repository pattern
/wind snippet repository

# Entity com multi-tenancy
/wind snippet entity
```

---

## üìã GATILHOS AUTOM√ÅTICOS

### Ao Modificar Arquivos
- **ViewModels**: Verificar MVVM + Hilt + StateFlow
- **DAOs**: Verificar queries + @Query annotations
- **Repositories**: Verificar interface + impl + sync
- **Entities**: Verificar empresa_id + rota_id

### Ao Fazer Build
- Verificar multi-tenancy
- Validar offline-first
- Checar logs estruturados
- Contar builds (m√°x 2)

### Ao Falhar Teste
- Identificar regress√£o
- Verificar cobertura
- Sugerir corre√ß√£o
- Documentar aprendizado

---

## üéØ OBJETIVOS DOS WORKFLOWS

1. **Alta Autonomia**: IAs trabalham sem interven√ß√£o humana
2. **Diagn√≥stico R√°pido**: Problemas resolvidos em 15-30 min
3. **Zero Loops**: M√°ximo 2 builds por problema
4. **Qualidade**: C√≥digo segue padr√µes do projeto
5. **Efici√™ncia**: Build otimizado com cache
6. **Monitoramento**: Sa√∫de do sistema vis√≠vel

---

*Workflows otimizados para desenvolvimento √°gil e confi√°vel.*
